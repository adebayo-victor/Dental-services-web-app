<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gateway Dental Care - Your Smile, Our Priority</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" xintegrity="sha512-z+rQ+9l+12A34A6K+4pS1/1V3Q2p+2m5s1t7x8w4w1/8/2F6D6T5eD6/7U6P5nQ2o0t7f4r9+w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Custom scrollbar for a sleek look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f1e5e; /* Dark blue from logo */
        }
        ::-webkit-scrollbar-thumb {
            background: #E00000; /* Red from logo */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #C00000;
        }

        /* Subtle background patterns (abstract waves/lines inspired by logo) */
        .hero-background-dental {
            background-image: url('data:image/svg+xml;utf8,<svg width="100%" height="100%" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="wave-lines" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M0 10 Q 5 5 10 10 T 20 10" stroke="%231a1a2e" stroke-width="0.3" fill="none"/></pattern></defs><rect width="100%" height="100%" fill="url(%23wave-lines)"/></svg>');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
        }
        .section-pattern-dental {
            background-image: url('data:image/svg+xml;utf8,<svg width="100%" height="100%" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="dots-and-crosses" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="0.5" fill="%232C2C40"/><path d="M5 10 L15 10 M10 5 L10 15" stroke="%232C2C40" stroke-width="0.2"/></pattern></defs><rect width="100%" height="100%" fill="url(%23dots-and-crosses)"/></svg>');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
        }
        .svg-icon {
            display: inline-block;
            width: 24px;
            height: 24px;
            stroke-width: 2;
            stroke: currentColor;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* Styling for the new service price overlay */
        .service-price-overlay, .auth-overlay, .forgot-password-overlay, .reset-password-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent dark background */
            backdrop-filter: blur(8px); /* Blur the content behind the overlay */
            -webkit-backdrop-filter: blur(8px); /* Safari support */
            z-index: 1000; /* Ensure it's on top of everything */
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .service-price-overlay.visible, .auth-overlay.visible, .forgot-password-overlay.visible, .reset-password-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .service-price-content, .auth-content, .forgot-password-content, .reset-password-content {
            background-color: #1A1A2E; /* Dark blue background */
            padding: 2.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            width: 90%;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            color: white; /* Ensure text is visible inside the content box */
            max-height: 90vh; /* Limit height for scrollability */
            overflow-y: auto; /* Enable scrolling for content */
        }
        .auth-content, .forgot-password-content, .reset-password-content {
            max-width: 450px; /* Smaller for auth forms */
        }

        .service-price-overlay.visible .service-price-content, .auth-overlay.visible .auth-content, .forgot-password-overlay.visible .forgot-password-content, .reset-password-overlay.visible .reset-password-content {
            transform: translateY(0);
        }

        .close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #E00000;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-button:hover {
            color: #C00000;
        }

        /* Styling for the list items inside the overlay */
        .service-list {
            list-style: none; /* Remove default bullet points */
            padding: 0;
        }

        .service-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #2C2C40; /* Background for each list item */
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem; /* Space between items */
            font-size: 1.125rem; /* text-lg */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .service-list li:last-child {
            margin-bottom: 0; /* No margin after the last item */
        }

        .service-list li .service-name {
            display: flex;
            align-items: center;
            gap: 0.75rem; /* Space between icon and text */
            color: white;
            font-weight: 600; /* font-semibold */
        }

        .service-list li .service-price {
            color: #E00000; /* Red color for price */
            font-weight: bold;
        }
        .booking-confirmation-overlay {
            /* ... other styles ... */
            opacity: 0;
            visibility: hidden;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent dark background */
            backdrop-filter: blur(8px); /* Blur the content behind the overlay */
            -webkit-backdrop-filter: blur(8px); /* Safari support */
            z-index: 1000; /* Ensure it's on top of everything */
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .booking-confirmation-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        /* New styles for testimonial summary boxes */
        .testimonial-summary-box {
            background-color: #2C2C40; /* Card background */
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(224, 0, 0, 0.1); /* Subtle red border */
        }
        .testimonial-summary-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
            border-color: rgba(224, 0, 0, 0.4); /* Highlight border on hover */
        }
        .testimonial-summary-box .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        /* Style for the full testimonial display within the overlay */
        .full-testimonial-display {
            position: absolute; /* Positioned within the main overlay content */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #1A1A2E; /* Dark blue background, same as service-price-content */
            padding: 2.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            z-index: 1010; /* Higher z-index than other content in the overlay */
            text-align: center;
            overflow-y: auto; /* Allow scrolling for long testimonials */
        }
        .full-testimonial-display.visible {
            opacity: 1;
            visibility: visible;
        }

        /* Styles for the main content to be hidden initially */
        body.auth-required > *:not(.auth-overlay):not(.forgot-password-overlay):not(.reset-password-overlay) {
            display: none;
        }
        body.auth-required {
            overflow: hidden; /* Prevent scrolling of background content */
        }

        /* Styles for appointment table */
        #myAppointmentsOverlay .appointments-table-container {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #0F1E5E;
            border-radius: 0.5rem;
        }
        #myAppointmentsOverlay table {
            width: 100%;
            border-collapse: collapse;
        }
        #myAppointmentsOverlay th, #myAppointmentsOverlay td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(224, 0, 0, 0.1);
        }
        #myAppointmentsOverlay th {
            background-color: rgba(224, 0, 0, 0.2);
            color: #E00000;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9rem;
        }
        #myAppointmentsOverlay tr:hover {
            background-color: rgba(26, 43, 106, 0.2);
        }
        #myAppointmentsOverlay .status-pending { background-color: rgba(255, 165, 0, 0.2); color: orange; }
        #myAppointmentsOverlay .status-valid { background-color: rgba(0, 128, 0, 0.2); color: green; }
        #myAppointmentsOverlay .status-cancelled { background-color: rgba(255, 0, 0, 0.2); color: red; }
    </style>
</head>
<body class="bg-[#1A1A2E] text-white font-sans antialiased auth-required">

    <!-- Login Overlay -->
    <div id="loginOverlay" class="auth-overlay visible">
        <div class="auth-content">
            <h2 class="text-3xl font-bold text-white mb-8 text-center">Login to Gateway Dental Care</h2>
            <form id="loginForm" class="space-y-6">
                <div>
                    <label for="login_email" class="block text-gray-300 text-sm font-bold mb-2">Email</label>
                    <input type="email" id="login_email" name="email"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="your@email.com" required>
                </div>
                <div>
                    <label for="login_password" class="block text-gray-300 text-sm font-bold mb-2">Password</label>
                    <input type="password" id="login_password" name="password"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="********" required>
                </div>
                <button type="submit" class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105">
                    Login
                </button>
            </form>
            <p class="text-center text-gray-400 mt-6">Don't have an account? <a href="#" id="showSignup" class="text-[#E00000] hover:underline">Sign Up</a></p>
            <p class="text-center text-gray-400 mt-2">
                <a href="#" id="forgotPasswordLink" class="text-[#E00000] hover:underline">Forgot Password?</a>
            </p>
            <p id="loginMessage" class="text-center mt-4 text-red-400"></p>
        </div>
    </div>

    <!-- Signup Overlay -->
    <div id="signupOverlay" class="auth-overlay">
        <div class="auth-content">
            <h2 class="text-3xl font-bold text-white mb-8 text-center">Sign Up for Gateway Dental Care</h2>
            <form id="signupForm" class="space-y-6">
                <div>
                    <label for="signup_name" class="block text-gray-300 text-sm font-bold mb-2">Full Name</label>
                    <input type="text" id="signup_name" name="full_name"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="Your Full Name" required>
                </div>
                <div>
                    <label for="signup_email" class="block text-gray-300 text-sm font-bold mb-2">Email</label>
                    <input type="email" id="signup_email" name="email"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="your@email.com" required>
                </div>
                <div>
                    <label for="signup_phone" class="block text-gray-300 text-sm font-bold mb-2">Phone Number</label>
                    <input type="tel" id="signup_phone" name="phone"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="e.g., +1234567890" required>
                </div>
                <div>
                    <label for="signup_password" class="block text-gray-300 text-sm font-bold mb-2">Password</label>
                    <input type="password" id="signup_password" name="password"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="********" required>
                </div>
                <button type="submit" class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105">
                    Sign Up
                </button>
            </form>
            <p class="text-center text-gray-400 mt-6">Already have an account? <a href="#" id="showLogin" class="text-[#E00000] hover:underline">Login</a></p>
            <p id="signupMessage" class="text-center mt-4 text-red-400"></p>
        </div>
    </div>

    <!-- Forgot Password Overlay with OTP -->
    <div id="forgotPasswordOverlay" class="forgot-password-overlay">
        <div class="forgot-password-content">
            <button id="closeForgotPasswordOverlay" class="close-button">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center">Forgot Password</h2>
            <form id="forgotPasswordForm" class="space-y-6">
                <div id="forgotEmailSection">
                    <div>
                        <label for="forgot_email" class="block text-gray-300 text-sm font-bold mb-2">Your Email</label>
                        <input type="email" id="forgot_email" name="email"
                               class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                               placeholder="your@email.com" required>
                    </div>
                    <button type="button" id="sendOtpBtn" class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105">
                        Send OTP
                    </button>
                </div>

                <div id="otpVerificationSection" class="hidden space-y-6">
                    <p class="text-center text-gray-400">An OTP has been sent to your email. Please enter it below.</p>
                    <div>
                        <label for="otp_input" class="block text-gray-300 text-sm font-bold mb-2">Enter OTP</label>
                        <input type="text" id="otp_input" name="otp"
                               class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                               placeholder="XXXXXX" maxlength="6" required>
                    </div>
                    <button type="button" id="verifyOtpBtn" class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105">
                        Verify OTP
                    </button>
                    <p class="text-center text-gray-400 mt-4">
                        <a href="#" id="resendOtpLink" class="text-[#E00000] hover:underline">Resend Code?</a>
                    </p>
                </div>
            </form>
            <p id="forgotPasswordMessage" class="text-center mt-4 text-red-400"></p>
            <p id="forgotPasswordSuccessMessage" class="text-center mt-4 text-green-400 hidden"></p>
        </div>
    </div>

    <!-- NEW: Reset Password Overlay (The Third Page) -->
    <div id="resetPasswordOverlay" class="reset-password-overlay">
        <div class="reset-password-content">
            <button id="closeResetPasswordOverlay" class="close-button">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center">Set New Password</h2>
            <form id="resetPasswordForm" class="space-y-6">
                <div>
                    <label for="new_password" class="block text-gray-300 text-sm font-bold mb-2">New Password</label>
                    <input type="password" id="new_password" name="new_password"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="Enter new password" required>
                </div>
                <div>
                    <label for="confirm_new_password" class="block text-gray-300 text-sm font-bold mb-2">Confirm New Password</label>
                    <input type="password" id="confirm_new_password" name="confirm_new_password"
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]"
                           placeholder="Confirm new password" required>
                </div>
                <button type="submit" id="setNewPasswordBtn" class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105">
                    Set New Password
                </button>
            </form>
            <p id="resetPasswordMessage" class="text-center mt-4 text-red-400"></p>
            <p id="resetPasswordSuccessMessage" class="text-center mt-4 text-green-400 hidden"></p>
        </div>
    </div>

    <nav class="sticky top-0 z-50 bg-[#1A1A2E] bg-opacity-95 backdrop-blur-sm shadow-lg">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="#" class="flex items-center space-x-3">
                <img src="{{url_for('static', filename='assets/images/Gemini_Generated_Image_563oi8563oi8563o.png')}}" alt="Gateway Dental Care Logo" class="h-10 w-auto">
                <span class="text-2xl font-bold text-white hover:text-[#E00000] transition-colors duration-300 hidden md:block">Gateway Dental Care</span>
            </a>
            <div class="hidden md:flex space-x-8">
                <a href="#hero" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">Home</a>
                <a href="#services" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">Services</a>
                <a href="#about" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">About Us</a>
                <a href="#ceo-portfolio" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">Our Founder</a>
                <a href="#gallery" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">Gallery</a>
                <a href="#testimonials" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">Testimonials</a>
                <a href="#contact" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">Booking</a>
                <a href="https://hhxsq4xb-8000.uks1.devtunnels.ms/blog" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Blog</a>
                <a href="#" id="myAppointmentsNavLink" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg">My Appointments</a>
                <button id="logoutButton" class="text-white hover:text-[#E00000] transition-colors duration-300 text-lg bg-transparent border border-[#E00000] px-4 py-2 rounded-full">Logout</button>
            </div>
            <button class="md:hidden text-white focus:outline-none mobile-menu-btn">
                <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
        <div class="md:hidden bg-[#1A1A2E] py-4 hidden" id="mobile-menu">
            <a href="#hero" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Home</a>
            <a href="#services" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Services</a>
            <a href="#about" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">About Us</a>
            <a href="#ceo-portfolio" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Our Founder</a>
            <a href="#gallery" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Gallery</a>
            <a href="#testimonials" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Testimonials</a>
            <a href="#contact" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Booking</a>
            <a href="https://hhxsq4xb-8000.uks1.devtunnels.ms/blog" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">Blog</a>
            <a href="#" id="myAppointmentsNavLinkA" class="block px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300">My Appointments</a>
            <button id="mobileLogoutButton" class="block w-full text-left px-4 py-2 text-white hover:bg-[#2C2C40] transition-colors duration-300 bg-transparent border border-[#E00000] rounded-full mt-2">Logout</button>
        </div>
    </nav>

    <section id="hero" class="relative min-h-screen flex items-center justify-center text-center p-8 hero-background-dental">
        <div class="absolute inset-0 bg-gradient-to-t from-[#1A1A2E] to-transparent opacity-80 z-10"></div>
        <div class="relative z-20 max-w-4xl mx-auto">
            <h1 class="text-5xl md:text-7xl font-extrabold leading-tight text-white mb-6 animate-fade-in-up">
                Experience a Brighter, Healthier <span class="text-[#E00000]">Smile</span>
            </h1>
            <p class="text-lg md:text-xl text-gray-300 mb-10 animate-fade-in-up delay-200">
                {{info.tagline}}
            </p>
            <a href="#contact" class="inline-block bg-[#E00000] text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-transform transform hover:scale-105 duration-300 animate-fade-in-up delay-400">
                Book Your Appointment
            </a>
        </div>
    </section>

    <section id="services" class="py-20 px-8 bg-[#1A1A2E] section-pattern-dental">
        <div class="container mx-auto text-center">
            <h2 class="text-4xl font-bold text-white mb-12">Our Comprehensive Dental Services</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 group" service-price="$150">
                    <div class="text-[#E00000] mb-6 inline-block p-4 rounded-full bg-[#1A1A2E] group-hover:bg-[#E00000] group-hover:text-white transition-all duration-300">
                        <i class="fas fa-tooth text-4xl"></i> </div>
                    <h3 class="text-2xl font-semibold text-white mb-4">General Dentistry</h3>
                    <p class="text-gray-300">Routine check-ups, cleanings, fillings, and preventive care for all ages.</p>
                </div>
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 group" service-price="$600">
                    <div class="text-[#E00000] mb-6 inline-block p-4 rounded-full bg-[#1A1A2E] group-hover:bg-[#E00000] group-hover:text-white transition-all duration-300">
                        <i class="fas fa-magic text-4xl"></i> </div>
                    <h3 class="text-2xl font-semibold text-white mb-4">Cosmetic Dentistry</h3>
                    <p class="text-gray-300">Teeth whitening, veneers, bonding, and smile makeovers for a dazzling smile.</p>
                </div>
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 group" service-price="$3000">
                    <div class="text-[#E00000] mb-6 inline-block p-4 rounded-full bg-[#1A1A2E] group-hover:bg-[#E00000] group-hover:text-white transition-all duration-300">
                        <i class="fas fa-align-left text-4xl"></i> </div>
                    <h3 class="text-2xl font-semibold text-white mb-4">Orthodontics</h3>
                    <p class="text-gray-300">Traditional braces and clear aligners to straighten your smile.</p>
                </div>
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 group" service-price="$4000">
                    <div class="text-[#E00000] mb-6 inline-block p-4 rounded-full bg-[#1A1A2E] group-hover:bg-[#E00000] group-hover:text-white transition-all duration-300">
                        <i class="fas fa-fill-drip text-4xl"></i> </div>
                    <h3 class="text-2xl font-semibold text-white mb-4">Dental Implants</h3>
                    <p class="text-gray-300">Durable and natural-looking solutions for missing teeth.</p>
                </div>
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 group" service-price="$250">
                    <div class="text-[#E00000] mb-6 inline-block p-4 rounded-full bg-[#1A1A2E] group-hover:bg-[#E00000] group-hover:text-white transition-all duration-300">
                        <i class="fas fa-ambulance text-4xl"></i> </div>
                    <h3 class="text-2xl font-semibold text-white mb-4">Emergency Dentistry</h3>
                    <p class="text-gray-300">Prompt care for dental emergencies when you need it most.</p>
                </div>
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 group" service-price="$100">
                    <div class="text-[#E00000] mb-6 inline-block p-4 rounded-full bg-[#1A1A2E] group-hover:bg-[#E00000] group-hover:text-white transition-all duration-300">
                        <i class="fas fa-child text-4xl"></i> </div>
                    <h3 class="text-2xl font-semibold text-white mb-4">Pediatric Dentistry</h3>
                    <p class="text-gray-300">Gentle and friendly dental care specifically designed for children.</p>
                </div>
            </div>
            <button id="viewServicePrices" class="mt-12 inline-block bg-[#E00000] text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-transform transform hover:scale-105 duration-300">
                View All Service Prices
            </button>
        </div>
    </section>

    <section id="about" class="py-20 px-8 bg-[#1A1A2E] border-t border-b border-[#2C2C40] section-pattern-dental">
        <div class="container mx-auto grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
            <div class="relative">
                <h2 class="text-4xl font-bold text-white mb-6">About Gateway Dental Care</h2>
                <p class="text-gray-300 leading-relaxed mb-6 text-lg">
                    At Gateway Dental Care, your oral health and comfort are our top priorities. Led by a team of highly skilled and compassionate dental professionals, we are committed to providing personalized care in a welcoming and state-of-the-art environment.
                </p>
                <p class="text-gray-300 leading-relaxed text-lg">
                    We believe in empowering our patients with knowledge and offering a full spectrum of dental services, from routine check-ups to advanced cosmetic procedures, ensuring a healthy and radiant smile for life.
                </p>
                <div class="absolute -bottom-10 -left-10 w-48 h-48 opacity-20 hidden lg:block">
                    <svg class="w-full h-full text-[#0F1E5E]" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 100 Q 50 50 100 100 T 180 100" stroke="currentColor" stroke-width="2" stroke-dasharray="4 4"/>
                        <path d="M20 120 Q 50 70 100 120 T 180 120" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
            </div>
            <div class="relative p-6 bg-[#2C2C40] rounded-lg shadow-2xl flex justify-center items-center">
                <img src="https://via.placeholder.com/600x400/0F1E5E/FFFFFF?text=Our+Modern+Clinic" alt="Gateway Dental Clinic" class="rounded-lg object-cover w-full h-auto">
                <div class="absolute inset-0 flex justify-center items-center opacity-10">
                    <svg class="w-full h-full text-white" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="10" y="10" width="80" height="80" rx="5" ry="5" stroke="currentColor" stroke-width="1"/>
                        <line x1="10" y1="50" x2="90" y2="50" stroke="currentColor" stroke-width="0.5"/>
                        <line x1="50" y1="10" x2="50" y2="90" stroke="currentColor" stroke-width="0.5"/>
                    </svg>
                </div>
            </div>
        </div>
    </section>

    <section id="ceo-portfolio" class="py-20 px-8 bg-[#1A1A2E] border-b border-[#2C2C40] section-pattern-dental">
        <div class="container mx-auto grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
            <div class="relative bg-[#2C2C40] p-8 rounded-lg shadow-2xl text-center">
                <img src="https://via.placeholder.com/200x200/E00000/FFFFFF?text=Dr.+Oluwafemi" alt="Dr. Oluwafemi Ogunsakin - CEO" class="w-48 h-48 rounded-full mx-auto mb-6 object-cover border-4 border-[#E00000]">
                <h3 class="text-3xl font-bold text-white mb-2">Dr. Oluwafemi Ogunsakin, Bsc</h3>
                <p class="text-[#E00000] text-xl font-semibold mb-6">Founder & Chief Dental Officer</p>
                <div class="text-gray-300 text-left leading-relaxed space-y-4">
                    <p>Dr. Oluwafemi Ogunsakin is the visionary leader behind Gateway Dental Care. With over 20 years of experience in restorative and cosmetic dentistry, Dr. Oluwafemi passion for oral health and patient-centric care led her to establish this clinic with a mission to deliver unparalleled dental services.</p>
                    <p class="italic text-lg">"My goal is to make every patient feel confident and comfortable, knowing they are receiving the highest standard of care for a healthy, beautiful smile."</p>
                </div>
                <div class="flex justify-center space-x-6 mt-8">
                    <a href="#" class="text-gray-400 hover:text-[#E00000] transition-colors duration-300" aria-label="Dr. Oluwafemi's LinkedIn">
                        <i class="fab fa-linkedin-in text-2xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-[#E00000] transition-colors duration-300" aria-label="Dr. Oluwafemi's Twitter">
                        <i class="fab fa-twitter text-2xl"></i>
                    </a>
                </div>
            </div>
            <div class="relative p-6">
                <h2 class="text-4xl font-bold text-white mb-6">Our Philosophy on Patient Care</h2>
                <p class="text-gray-300 leading-relaxed mb-6 text-lg">
                    Dr. Oluwafemi's philosophy is rooted in a holistic approach to dental health, emphasizing prevention, education, and personalized treatment plans. She believes in building long-term relationships with patients based on trust and mutual respect.
                </p>
                <ul class="list-disc list-inside text-gray-300 text-lg space-y-3">
                    <li>**Compassionate Care**: Ensuring comfort and understanding at every step.</li>
                    <li>**Advanced Technology**: Utilizing the latest dental innovations for precision.</li>
                    <li>**Patient Education**: Empowering you with knowledge for optimal oral health.</li>
                    <li>**Ethical Practice**: Upholding the highest standards of integrity and transparency.</li>
                </ul>
                <div class="absolute -top-10 -right-10 w-64 h-64 opacity-15 hidden lg:block">
                    <svg class="w-full h-full text-[#0F1E5E]" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M50 50 C 20 80, 80 120, 50 150 C 80 120, 140 80, 110 50 Z" stroke="currentColor" stroke-width="1.5" stroke-dasharray="3 2"/>
                        <circle cx="100" cy="100" r="40" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                </div>
            </div>
        </div>
    </section>

    <section id="gallery" class="py-20 px-8 bg-[#1A1A2E] section-pattern-dental">
        <div class="container mx-auto text-center">
            <h2 class="text-4xl font-bold text-white mb-12">Our Smile Transformations Gallery</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                <div class="relative bg-[#2C2C40] rounded-lg shadow-xl overflow-hidden group">
                    <img src="https://via.placeholder.com/700x500/0F1E5E/FFFFFF?text=Smile+Transformation+1" alt="Smile Transformation 1" class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300">
                    <div class="p-6 text-left">
                        <h3 class="text-2xl font-semibold text-white mb-2">Porcelain Veneers</h3>
                        <p class="text-gray-400 mb-4">Achieving a perfect, natural-looking smile with custom veneers.</p>
                        <a href="#" class="text-[#E00000] hover:underline text-lg flex items-center">
                            View Details
                            <i class="fas fa-arrow-right ml-2 text-sm"></i>
                        </a>
                    </div>
                </div>
                <div class="relative bg-[#2C2C40] rounded-lg shadow-xl overflow-hidden group">
                    <img src="https://via.placeholder.com/700x500/0F1E5E/FFFFFF?text=Smile+Transformation+2" alt="Smile Transformation 2" class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300">
                    <div class="p-6 text-left">
                        <h3 class="text-2xl font-semibold text-white mb-2">Invisalign Treatment</h3>
                        <p class="text-gray-400 mb-4">Discreetly straightening teeth with clear aligners.</p>
                        <a href="#" class="text-[#E00000] hover:underline text-lg flex items-center">
                            View Details
                            <i class="fas fa-arrow-right ml-2 text-sm"></i>
                        </a>
                    </div>
                </div>
                <div class="relative bg-[#2C2C40] rounded-lg shadow-xl overflow-hidden group">
                    <img src="https://via.placeholder.com/700x500/0F1E5E/FFFFFF?text=Smile+Transformation+3" alt="Smile Transformation 3" class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300">
                    <div class="p-6 text-left">
                        <h3 class="text-2xl font-semibold text-white mb-2">Professional Whitening</h3>
                        <p class="text-gray-400 mb-4">Transforming smiles with professional in-office teeth whitening.</p>
                        <a href="#" class="text-[#E00000] hover:underline text-lg flex items-center">
                            View Details
                            <i class="fas fa-arrow-right ml-2 text-sm"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="mt-16 border-t border-[#E00000] opacity-30 w-3/4 mx-auto relative">
                <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-[#1A1A2E] px-4">
                    <i class="fas fa-grin-beam text-2xl text-[#E00000]"></i> </div>
            </div>
        </div>
    </section>

    <section id="testimonials" class="py-20 px-8 bg-[#1A1A2E] section-pattern-dental">
        <div class="container mx-auto text-center">
            <h2 class="text-4xl font-bold text-white mb-12">What Our Patients Say</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl border border-[#E00000] border-opacity-30">
                    <p class="text-gray-300 italic text-lg mb-6">"The team at Gateway Dental Care is truly exceptional. From the moment I walked in, I felt comfortable and well-cared for. My new smile is amazing!"</p>
                    <div class="flex items-center justify-center">
                        <img src="https://via.placeholder.com/80x80/E00000/FFFFFF?text=SM" alt="Patient Avatar" class="w-16 h-16 rounded-full mr-4 border-2 border-[#E00000]">
                        <div>
                            <p class="font-semibold text-white text-xl">Sarah M.</p>
                            <p class="text-gray-400">Happy Patient</p>
                        </div>
                    </div>
                </div>
                <div class="bg-[#2C2C40] p-8 rounded-lg shadow-xl border border-[#E00000] border-opacity-30">
                    <p class="text-gray-300 italic text-lg mb-6">"I used to dread dental visits, but Gateway Dental Care changed that. Their gentle approach and clear explanations made me feel at ease. Highly recommend!"</p>
                    <div class="flex items-center justify-center">
                        <img src="https://via.placeholder.com/80x80/E00000/FFFFFF?text=JL" alt="Patient Avatar" class="w-16 h-16 rounded-full mr-4 border-2 border-[#E00000]">
                        <div>
                            <p class="font-semibold text-white text-xl">John L.</p>
                            <p class="text-gray-400">Satisfied Patient</p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- New Button to show the Testimonial Form Overlay -->
            <button id="addTestimonialBtn" class="mt-12 inline-block bg-[#E00000] text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-transform transform hover:scale-105 duration-300">
                Share Your Experience
            </button>
            <!-- New Button to show the All Testimonials Overlay -->
            <button id="viewAllTestimonialsBtn" class="mt-4 inline-block bg-[#0F1E5E] text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-[#1A2B6A] transition-transform transform hover:scale-105 duration-300">
                View All Testimonials
            </button>
        </div>
    </section>

    <section id="contact" class="py-20 px-8 bg-[#1A1A2E] border-t border-[#2C2C40]">
        <div class="container mx-auto grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
            <div>
                <h2 class="text-4xl font-bold text-white mb-6">Schedule a session with Gateway Dental Care today</h2>
                <p class="text-gray-300 leading-relaxed mb-8">
                    Schedule your next appointment or <a href="#contact" class="text-[#E00000] hover:underline">ask us a question</a>. We look forward to hearing from you!
                </p>
                <div class="space-y-6">
                    <div class="flex items-center">
                        <i class="fas fa-envelope text-[#E00000] text-3xl mr-4"></i>
                        <p class="text-white text-lg">{{info.email}}</p>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-phone-alt text-[#E00000] text-3xl mr-4"></i>
                        <p class="text-white text-lg">{{info.phone_number}}</p>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-map-marker-alt text-[#E00000] text-3xl mr-4"></i>
                        <p class="text-white text-lg">{{info.address}}</p>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-clock text-[#E00000] text-3xl mr-4"></i>
                        <p class="text-white text-lg">{{info.operating_hours}}</p>
                    </div>
                </div>
            </div>
            <div class="bg-[#2C2C40] p-8 rounded-lg shadow-2xl">
                <form class="space-y-6">
                    <div>
                        <label for="name" class="block text-gray-300 text-sm font-bold mb-2">Name</label>
                        <input type="text" id="name" name="name" class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" placeholder="Your Name">
                    </div>
                    <div>
                        <label for="email" class="block text-gray-300 text-sm font-bold mb-2">Email</label>
                        <input type="email" id="email" name="email" class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" placeholder="your@email.com">
                    </div>
                    <div>
                        <label for="phone" class="block text-gray-300 text-sm font-bold mb-2">Phone (Optional)</label>
                        <input type="tel" id="phone" name="phone" class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" placeholder="Your Phone Number">
                    </div>
                    <span class="fas fa-tooth text-4xl" id="pre-order">Pre-order</span>
                    <div>
                        <label for="symptoms" class="block text-gray-300 text-sm font-bold mb-2">Symptoms</label>
                        <textarea id="symptoms" name="symptoms" rows="6" class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:shadow-outline focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" placeholder="Your message..."></textarea>
                    </div>
                    <span  class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105" id="book-session">
                        Book session
                    </span>
                </form>
            </div>
        </div>
    </section>

    <footer class="bg-[#0D0D1A] py-8 px-8 text-center text-gray-400 border-t border-[#2C2C40]">
        <div class="container mx-auto">
            <div class="flex flex-wrap justify-center space-x-6 mb-4">
                <a href="#hero" class="hover:text-[#E00000] transition-colors duration-300">Home</a>
                <a href="#services" class="hover:text-[#E00000] transition-colors duration-300">Services</a>
                <a href="#about" class="hover:text-[#E00000] transition-colors duration-300">About</a>
                <a href="#ceo-portfolio" class="hover:text-[#E00000] transition-colors duration-300">Our Founder</a>
                <a href="#gallery" class="hover:text-[#E00000] transition-colors duration-300">Gallery</a>
                <a href="#contact" class="hover:text-[#E00000] transition-colors duration-300">Contact</a>
            </div>
            <p>&copy; 2025 Gateway Dental Care. All rights reserved.</p>
            <div class="flex justify-center space-x-6 mt-4">
                <a href="#" class="text-gray-400 hover:text-[#E00000] transition-colors duration-300">
                    <i class="fab fa-facebook-f text-2xl"></i>
                </a>
                <a href="#" class="text-gray-400 hover:text-[#E00000] transition-colors duration-300">
                    <i class="fab fa-instagram text-2xl"></i>
                </a>
                <a href="#" class="text-gray-400 hover:text-[#E00000] transition-colors duration-300">
                    <i class="fab fa-twitter text-2xl"></i>
                </a>
            </div>
        </div>
    </footer>

    <div id="servicePriceOverlay" class="service-price-overlay">
        <div class="service-price-content">
            <div id="cart" class="bg-gray-800 p-6 rounded-lg mb-8">
                <h3 class="text-2xl font-bold text-white mb-4">Your Selected Services</h3>
                <div id="cartIconsContainer" class="flex flex-wrap gap-3 p-4 border border-gray-700 rounded-lg bg-[#0F1E5E] min-h-[60px] justify-center items-center">
                    </div>
                <p class="text-gray-400 text-sm mt-2 text-center">Click on services below to add them to your cart.</p>
            </div>
            <button id="closeServicePriceOverlay" class="close-button">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center">Detailed Service Prices</h2>
            <p class="text-gray-300 text-center mb-6">Here's a comprehensive list of our dental services and their estimated prices:</p>
            {% if services %}
                <ul class="service-list space-y-4">
                {% for service in services %}
                    <li class="bg-gray-700 p-4 rounded-lg flex justify-between items-center cursor-pointer hover:bg-gray-600 transition-colors duration-200 group">
                        <span class="service-name flex items-center"><i class="{{service.fa_icon_class}} text-[#E00000] text-xl mr-3 group-hover:scale-110 transition-transform"></i>{{service.name}}</span>
                        <span class="service-price font-bold text-white">{{service.price}}</span>
                    </li>
                {% endfor %}
            </ul>
            {% else %}
                <p>No services in the database, just book a session</p>
            {% endif %}
            
        </div>
    </div>
    <div id="bookingConfirmationOverlay" class="booking-confirmation-overlay">
        <div class="booking-confirmation-content">
            <button id="closeBookingConfirmationOverlay" class="close-button">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center">Confirm Your Session Details</h2>
    
            <div class="mb-6">
                <h3 class="text-xl font-semibold text-white mb-4">Selected Services:</h3>
                <div id="confirmedServiceIcons" class="flex flex-wrap gap-3 p-4 border border-gray-700 rounded-lg bg-[#0F1E5E] min-h-[60px] justify-center items-center">
                    <p class="text-gray-400 text-sm italic" id="no-services">No services selected yet.</p>
                </div>
                <p class="text-gray-400 text-sm mt-2 text-center">Review your selected services before confirming.</p>
            </div>
    
            <div class="mb-8 p-4 bg-[#2C2C40] rounded-lg shadow">
                <h3 class="text-xl font-semibold text-white mb-4">Your Contact Information:</h3>
                <p class="text-gray-300 mb-2"><strong class="text-[#E00000]">Name:</strong> <span id="confirmName"></span></p>
                <p class="text-gray-300 mb-2"><strong class="text-[#E00000]">Email:</strong> <span id="confirmEmail"></span></p>
                <p class="text-gray-300 mb-2"><strong class="text-[#E00000]">Phone:</strong> <span id="confirmPhone"></span></p>
                <p class="text-gray-300"><strong class="text-[#E00000]">Symptoms/Message:</strong> <span id="confirmSymptoms"></span></p>
                <p class="text-gray-300"><strong class="text-[#E00000]">Bill:</strong> <span id="confirmBill"></span></p>
            </div>
            <form method="post" action="post_session">
                <input type="hidden" id="hidden-name" name="name">

                <!-- For Email -->
                <input type="hidden" id="hidden-email" name="email">

                <!-- For Phone -->
                <input type="hidden" id="hidden-phone" name="phone">

                <!-- For Bill -->
                <input type="hidden" id="hidden-bill" name="bill">

                <!-- For Services (could be a comma-separated list or JSON string if complex) -->
                <input type="hidden" id="hidden-services" name="services">

                <!-- For Symptoms -->
                <input type="hidden" id="hidden-symptoms" name="symptoms">

                <button id="confirmBookingButton" class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105">
                    Confirm & Book Session
                </button>
            </form>
        </div>
    </div>
    <!-- New Testimonial Form Overlay -->
    <div id="addTestimonialOverlay" class="service-price-overlay">
        <div class="service-price-content">
            <button id="closeAddTestimonialOverlay" class="close-button">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center">Share Your Experience</h2>
            <p class="text-gray-300 text-center mb-6">We'd love to hear your feedback!</p>
            <form id="testimonialForm" class="space-y-6">
                <div>
                    <label for="testimonial_name" class="block text-gray-300 text-sm font-bold mb-2">Your Name</label>
                    <input type="text" id="testimonial_name" name="testimonial_name" 
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" 
                           placeholder="e.g., Jane Doe" required>
                </div>
                <div>
                    <label for="testimonial_email" class="block text-gray-300 text-sm font-bold mb-2">Your Email (Optional)</label>
                    <input type="email" id="testimonial_email" name="testimonial_email" 
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" 
                           placeholder="your@email.com">
                </div>
                <div>
                    <label for="testimonial_quote_input" class="block text-gray-300 text-sm font-bold mb-2">Your Testimonial</label>
                    <textarea id="testimonial_quote_input" name="testimonial_quote_input" rows="6" 
                              class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:shadow-outline focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" 
                              placeholder="Type your experience here..." required></textarea>
                </div>
                <div>
                    <label for="testimonial_author_description" class="block text-gray-300 text-sm font-bold mb-2">Your Role/Description (e.g., "Happy Patient")</label>
                    <input type="text" id="testimonial_author_description" name="testimonial_author_description" 
                           class="shadow appearance-none border border-[#E00000] border-opacity-50 rounded w-full py-3 px-4 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-[#E00000] bg-[#1A1A2E]" 
                           placeholder="e.g., Happy Patient" required>
                </div>
                <button type="submit" id="submitTestimonialBtn" class="w-full bg-[#E00000] text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-[#C00000] transition-colors duration-300 transform hover:scale-105">
                    Submit Testimonial
                </button>
                <p id="testimonialMessage" class="text-center mt-4"></p>
            </form>
        </div>
    </div>

    <!-- NEW: Testimonial Summary and Full View Overlay -->
    <div id="viewAllTestimonialsOverlay" class="service-price-overlay">
        <div class="service-price-content">
            <button id="closeAllTestimonialsOverlay" class="close-button">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center">All Patient Testimonials</h2>

            <div id="testimonialSummaryGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                <!-- Testimonial Summary Boxes - These would ideally be populated from a database -->
                {% if testimonials %}
                    {% for testimonial in testimonials%}
                        <div class="testimonial-summary-box"
                            data-author="{{testimonial.author_name}}"
                            data-description="{{testimonial.author_description}}"
                            data-quote="{{testimonial.quote}}"
                            data-avatar="https://via.placeholder.com/80x80/E00000/FFFFFF?text=SM">
                            <p class="text-gray-300 italic text-sm mb-3 line-clamp-3">"{{testimonial.quote}}"</p>
                            <div class="flex items-center justify-center mt-4">
                                <img src="https://via.placeholder.com/40x40/E00000/FFFFFF?text=SM" alt="Author Avatar" class="w-10 h-10 rounded-full mr-3 border-2 border-[#E00000]">
                                <div>
                                    <p class="font-semibold text-white text-md">{{testimonial.author_name}}</p>
                                    <p class="text-gray-400 text-xs">{{testimonial.author_description}}t</p>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {%else%}
                    <h2>No testimonials in here</h2>
                {% endif %}
                
            </div>
            <!-- NEW: Full Testimonial Display (Nested within the main overlay) -->
            <div id="fullTestimonialDisplay" class="full-testimonial-display">
                <button id="closeFullTestimonial" class="close-button">&times;</button>
                <h3 class="text-3xl font-bold text-white mb-6" id="fullTestimonialAuthor"></h3>
                <p class="text-[#E00000] text-xl font-semibold mb-4" id="fullTestimonialDescription"></p>
                <p class="text-gray-300 leading-relaxed text-lg italic mb-8" id="fullTestimonialQuote"></p>
                <div class="flex justify-center">
                    <img id="fullTestimonialAvatar" src="" alt="Author Avatar" class="w-24 h-24 rounded-full border-4 border-[#E00000] object-cover">
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: My Appointments Overlay -->
    <div id="myAppointmentsOverlay" class="service-price-overlay">
        <div class="service-price-content">
            <button id="closeMyAppointmentsOverlay" class="close-button">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-8 text-center">My Upcoming Appointments</h2>
            <div class="appointments-table-container bg-[#2C2C40] rounded-lg shadow-xl overflow-hidden">
                <table class="min-w-full">
                    <thead>
                        <tr>
                            <th class="py-3 px-4">Date</th>
                            <th class="py-3 px-4">Time</th>
                            <th class="py-3 px-4">Code</th>
                            <th class="py-3 px-4">Status</th>
                            <th class="py-3 px-4">Bill</th>
                            <th class="py-3 px-4">Notes</th>
                            <th class="py-3 px-4">Expires</th>
                        </tr>
                    </thead>
                    <tbody id="myAppointmentsTableBody">
                        <!-- Appointments will be loaded here by JavaScript -->
                        <tr><td colspan="7" class="py-4 text-center text-gray-400">Loading your appointments...</td></tr>
                    </tbody>
                </table>
            </div>
            <p id="noAppointmentsMessage" class="text-gray-400 mt-8 hidden">You have no appointments scheduled yet.</p>
        </div>
    </div>

    <script src="{{url_for('static', filename='assets/js/gateway.js')}}"></script>
    <!-- NEW: Embedded JavaScript for Testimonials Overlay and OTP Forgot Password -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const viewAllTestimonialsBtn = document.getElementById('viewAllTestimonialsBtn');
            const viewAllTestimonialsOverlay = document.getElementById('viewAllTestimonialsOverlay');
            const closeAllTestimonialsOverlay = document.getElementById('closeAllTestimonialsOverlay');
            const testimonialSummaryGrid = document.getElementById('testimonialSummaryGrid');

            const fullTestimonialDisplay = document.getElementById('fullTestimonialDisplay');
            const closeFullTestimonialBtn = document.getElementById('closeFullTestimonial');
            const fullTestimonialAuthor = document.getElementById('fullTestimonialAuthor');
            const fullTestimonialDescription = document.getElementById('fullTestimonialDescription');
            const fullTestimonialQuote = document.getElementById('fullTestimonialQuote');
            const fullTestimonialAvatar = document.getElementById('fullTestimonialAvatar');

            // Auth Overlays
            const loginOverlay = document.getElementById('loginOverlay');
            const signupOverlay = document.getElementById('signupOverlay');
            const showSignupLink = document.getElementById('showSignup');
            const showLoginLink = document.getElementById('showLogin');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const loginMessage = document.getElementById('loginMessage');
            const signupMessage = document.getElementById('signupMessage');
            const body = document.body;

            // NEW: Forgot Password elements
            const forgotPasswordLink = document.getElementById('forgotPasswordLink');
            const forgotPasswordOverlay = document.getElementById('forgotPasswordOverlay');
            const closeForgotPasswordOverlay = document.getElementById('closeForgotPasswordOverlay');
            const forgotEmailSection = document.getElementById('forgotEmailSection');
            const otpVerificationSection = document.getElementById('otpVerificationSection');
            const forgotEmailInput = document.getElementById('forgot_email');
            const sendOtpBtn = document.getElementById('sendOtpBtn');
            const otpInput = document.getElementById('otp_input');
            const verifyOtpBtn = document.getElementById('verifyOtpBtn');
            const resendOtpLink = document.getElementById('resendOtpLink');
            const forgotPasswordMessage = document.getElementById('forgotPasswordMessage');
            const forgotPasswordSuccessMessage = document.getElementById('forgotPasswordSuccessMessage');

            // NEW: Reset Password elements
            const resetPasswordOverlay = document.getElementById('resetPasswordOverlay');
            const closeResetPasswordOverlay = document.getElementById('closeResetPasswordOverlay');
            const newPasswordInput = document.getElementById('new_password');
            const confirmNewPasswordInput = document.getElementById('confirm_new_password');
            const setNewPasswordBtn = document.getElementById('setNewPasswordBtn');
            const resetPasswordMessage = document.getElementById('resetPasswordMessage');
            const resetPasswordSuccessMessage = document.getElementById('resetPasswordSuccessMessage');


            let userEmailForOtp = ''; // To store email for OTP verification

            // Booking and Testimonial form fields
            const bookingNameInput = document.getElementById('name');
            const bookingEmailInput = document.getElementById('email');
            const testimonialNameInput = document.getElementById('testimonial_name');
            const testimonialEmailInput = document.getElementById('testimonial_email');
            const testimonialQuoteInput = document.getElementById('testimonial_quote_input');
            const testimonialAuthorDescriptionInput = document.getElementById('testimonial_author_description'); // New field
            const testimonialForm = document.getElementById('testimonialForm');
            const submitTestimonialBtn = document.getElementById('submitTestimonialBtn');
            const testimonialMessage = document.getElementById('testimonialMessage');
            //needed for linking appointments
            const appointmentAnchor = document.getElementById('myAppointmentsNavLink')
            const appointmentAnchorA = document.querySelector('#myAppointmentsNavLinkA')

            // Logout Button
            const logoutButton = document.getElementById('logoutButton');
            const mobileLogoutButton = document.getElementById('mobileLogoutButton');


            // Function to show an overlay
            function showOverlay(overlayElement) {
                overlayElement.classList.add('visible');
            }

            // Function to hide an overlay
            function hideOverlay(overlayElement) {
                overlayElement.classList.remove('visible');
            }

            // Function to populate forms with user data
            function populateFormsWithUserData() {
                const userData = JSON.parse(sessionStorage.getItem('loggedInUser'));
                if (userData) {
                    if (bookingNameInput) bookingNameInput.value = userData.full_name || '';
                    if (bookingEmailInput) bookingEmailInput.value = userData.email || '';
                    if (testimonialNameInput) testimonialNameInput.value = userData.full_name || '';
                    if (testimonialEmailInput) testimonialEmailInput.value = userData.email || '';
                    appointmentAnchor.setAttribute('href','https://hhxsq4xb-8000.uks1.devtunnels.ms/' + 'my_appointments/' + userData.id)
                    appointmentAnchorA.setAttribute('href','https://hhxsq4xb-8000.uks1.devtunnels.ms/' + 'my_appointments/' + userData.id)
                }
            }

            // Function to handle logout
            function handleLogout() {
                sessionStorage.removeItem('loggedInUser'); // Clear user data
                // Optionally, you might want to call a backend logout endpoint here
                // fetch('/logout', { method: 'POST' });
                location.reload(); // Reload the page to show the login screen
            }

            // Initial state: Show login overlay and hide main content
            function initializeAuth() {
                // Check if user data exists in sessionStorage
                const userData = sessionStorage.getItem('loggedInUser');
                if (userData) {
                    // If user is already logged in, show main content and populate forms
                    body.classList.remove('auth-required');
                    hideOverlay(loginOverlay);
                    hideOverlay(signupOverlay);
                    hideOverlay(forgotPasswordOverlay); // Ensure forgot password is hidden
                    hideOverlay(resetPasswordOverlay); // Ensure reset password is hidden
                    populateFormsWithUserData();
                } else {
                    // If not logged in, show login overlay and hide main content
                    showOverlay(loginOverlay);
                    hideOverlay(signupOverlay); // Ensure signup is hidden initially
                    hideOverlay(forgotPasswordOverlay); // Ensure forgot password is hidden initially
                    hideOverlay(resetPasswordOverlay); // Ensure reset password is hidden initially
                    body.classList.add('auth-required'); // Hide main content
                }
            }

            // Call initializeAuth on page load
            initializeAuth();

            // Event listeners for logout buttons
            if (logoutButton) {
                logoutButton.addEventListener('click', handleLogout);
            }
            if (mobileLogoutButton) {
                mobileLogoutButton.addEventListener('click', handleLogout);
            }

            // Toggle between login and signup forms
            if (showSignupLink) {
                showSignupLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    hideOverlay(loginOverlay);
                    hideOverlay(forgotPasswordOverlay); // Hide forgot password if visible
                    hideOverlay(resetPasswordOverlay); // Hide reset password if visible
                    showOverlay(signupOverlay);
                    loginMessage.textContent = ''; // Clear messages
                    signupMessage.textContent = '';
                });
            }

            if (showLoginLink) {
                showLoginLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    hideOverlay(signupOverlay);
                    hideOverlay(forgotPasswordOverlay); // Hide forgot password if visible
                    hideOverlay(resetPasswordOverlay); // Hide reset password if visible
                    showOverlay(loginOverlay);
                    loginMessage.textContent = ''; // Clear messages
                    signupMessage.textContent = '';
                });
            }

            // Handle Login Form Submission
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('login_email').value;
                    const password = document.getElementById('login_password').value;

                    try {
                        const response = await fetch('https://hhxsq4xb-8000.uks1.devtunnels.ms/login', { // Replace with your actual login endpoint
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ email, password }),
                        });

                        const data = await response.json();

                        // Check both response.ok (HTTP status 2xx) and the custom 'successful' response
                        if (response.ok && data && data.length > 0 && data[0].response === 'successful') {
                            loginMessage.textContent = 'Login successful!';
                            loginMessage.style.color = 'green';
                            //set appointment link
                            console.log(appointmentAnchor)
                            appointmentAnchor.setAttribute('href','https://hhxsq4xb-8000.uks1.devtunnels.ms/' + 'my_appointments/' + data[0]['id'])
                            appointmentAnchorA.setAttribute('href','https://hhxsq4xb-8000.uks1.devtunnels.ms/' + 'my_appointments/' + data[0]['id'])
                            console.log('appointment link', appointmentAnchor.getAttribute('href'))
                            // Store the entire user object (data[0])
                            sessionStorage.setItem('loggedInUser', JSON.stringify(data[0])); 
                            populateFormsWithUserData(); // Populate forms immediately
                            setTimeout(() => {
                                hideOverlay(loginOverlay);
                                body.classList.remove('auth-required'); // Show main content
                            }, 500);
                        } else {
                            // If response.ok is false, or custom response is not 'successful'
                            loginMessage.textContent = data.message || 'Login failed. Please check your credentials.';
                            loginMessage.style.color = 'red';
                        }
                    } catch (error) {
                        console.error('Login error:', error);
                        loginMessage.textContent = 'An error occurred during login. Please try again.';
                        loginMessage.style.color = 'red';
                    }
                });
            }

            // Handle Signup Form Submission
            if (signupForm) {
                signupForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const fullName = document.getElementById('signup_name').value;
                    const email = document.getElementById('signup_email').value;
                    const phone = document.getElementById('signup_phone').value;
                    const password = document.getElementById('signup_password').value;

                    try {
                        const response = await fetch('https://hhxsq4xb-8000.uks1.devtunnels.ms/signup', { // Replace with your actual signup endpoint
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ full_name: fullName, email, phone, password }),
                        });

                        const data = await response.json();

                        // Check both response.ok (HTTP status 2xx) and the custom 'successful' response
                        if (response.ok && data && data.length > 0 && data[0].response === 'successful') {
                            signupMessage.textContent = 'Signup successful! You can now log in.';
                            signupMessage.style.color = 'green';
                            signupForm.reset(); // Clear the form
                            populateFormsWithUserData(); // Re-populate name/email
                            setTimeout(() => {
                                hideOverlay(signupOverlay);
                                showOverlay(loginOverlay); // Go back to login
                            }, 1500);
                        } else {
                            // If response.ok is false, or custom response is not 'successful'
                            signupMessage.textContent = data.message || 'Signup failed. Please try again.';
                            signupMessage.style.color = 'red';
                        }
                    } catch (error) {
                        console.error('Signup error:', error);
                        signupMessage.textContent = 'An error occurred during signup. Please try again.';
                        signupMessage.style.color = 'red';
                    }
                });
            }

            // Handle Testimonial Form Submission
            if (testimonialForm) {
                testimonialForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const name = testimonialNameInput.value;
                    const email = testimonialEmailInput.value;
                    const quote = testimonialQuoteInput.value;
                    const author_description = testimonialAuthorDescriptionInput.value; // Get the new field's value

                    testimonialMessage.textContent = 'Submitting testimonial...';
                    testimonialMessage.style.color = 'gray';

                    try {
                        const response = await fetch('https://hhxsq4xb-8000.uks1.devtunnels.ms/post_testimonial', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ name, email, quote, author_description }), // Include author_description
                        });

                        const data = await response.json();

                        if (response.ok && data && data.length > 0) {
                            if (data[0].response === 'testimonial added to backend') {
                                testimonialMessage.textContent = 'Testimonial submitted successfully!';
                                testimonialMessage.style.color = 'green';
                                testimonialForm.reset(); // Clear the form
                                populateFormsWithUserData(); // Re-populate name/email
                                setTimeout(() => {
                                    hideOverlay(document.getElementById('addTestimonialOverlay'));
                                    testimonialMessage.textContent = ''; // Clear message after closing
                                }, 1500);
                            } else if (data[0].response === 'not an existing patient') {
                                testimonialMessage.textContent = 'Error: You must be a registered patient to submit a testimonial.';
                                testimonialMessage.style.color = 'red';
                            } else {
                                testimonialMessage.textContent = data.message || 'Failed to submit testimonial.';
                                testimonialMessage.style.color = 'red';
                            }
                        } else {
                            testimonialMessage.textContent = 'Failed to submit testimonial. Server error.';
                            testimonialMessage.style.color = 'red';
                        }
                    } catch (error) {
                        console.error('Testimonial submission error:', error);
                        testimonialMessage.textContent = 'An error occurred during testimonial submission. Please try again.';
                        testimonialMessage.style.color = 'red';
                    }
                });
            }


            // Event listener for "View All Testimonials" button
            if (viewAllTestimonialsBtn) {
                viewAllTestimonialsBtn.addEventListener('click', () => {
                    showOverlay(viewAllTestimonialsOverlay);
                    // Ensure the full testimonial display is hidden when opening the summary view
                    hideOverlay(fullTestimonialDisplay);
                });
            }

            // Event listener for closing the "All Testimonials" overlay
            if (closeAllTestimonialsOverlay) {
                closeAllTestimonialsOverlay.addEventListener('click', () => {
                    hideOverlay(viewAllTestimonialsOverlay);
                });
            }

            // Event listener for clicking on individual testimonial summary boxes
            if (testimonialSummaryGrid) {
                testimonialSummaryGrid.addEventListener('click', (event) => {
                    const summaryBox = event.target.closest('.testimonial-summary-box');
                    if (summaryBox) {
                        // Populate the full testimonial display with data from the clicked box
                        fullTestimonialAuthor.textContent = summaryBox.dataset.author;
                        fullTestimonialDescription.textContent = summaryBox.dataset.description;
                        fullTestimonialQuote.textContent = summaryBox.dataset.quote;
                        fullTestimonialAvatar.src = summaryBox.dataset.avatar;

                        showOverlay(fullTestimonialDisplay); // Show the full testimonial view
                    }
                });
            }

            // Event listener for closing the full testimonial display
            if (closeFullTestimonialBtn) {
                closeFullTestimonialBtn.addEventListener('click', () => {
                    hideOverlay(fullTestimonialDisplay);
                });
            }

            /* --- Forgot Password Logic with OTP (for dental.html) --- */
            if (forgotPasswordLink) {
                forgotPasswordLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    hideOverlay(loginOverlay);
                    showOverlay(forgotPasswordOverlay);
                    forgotPasswordMessage.textContent = '';
                    forgotPasswordSuccessMessage.textContent = '';
                    forgotPasswordSuccessMessage.classList.add('hidden');
                    forgotEmailSection.classList.remove('hidden');
                    otpVerificationSection.classList.add('hidden');
                    forgotEmailInput.value = '';
                    otpInput.value = '';
                });
            }

            if (closeForgotPasswordOverlay) {
                closeForgotPasswordOverlay.addEventListener('click', () => {
                    hideOverlay(forgotPasswordOverlay);
                    showOverlay(loginOverlay); // Go back to login
                });
            }

            if (sendOtpBtn) {
                sendOtpBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    userEmailForOtp = forgotEmailInput.value;

                    if (!userEmailForOtp) {
                        forgotPasswordMessage.textContent = 'Please enter your email address.';
                        forgotPasswordMessage.style.color = 'red';
                        return;
                    }

                    forgotPasswordMessage.textContent = 'Sending OTP...';
                    forgotPasswordMessage.style.color = 'gray';
                    forgotPasswordSuccessMessage.classList.add('hidden');

                    try {
                        const response = await fetch('https://hhxsq4xb-8000.uks1.devtunnels.ms/get_otp', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ id: userEmailForOtp }) // 'id' is the email
                        });
                        const data = await response.json();

                        if (response.ok && data.response === 'successful') {
                            forgotPasswordMessage.textContent = '';
                            forgotPasswordSuccessMessage.textContent = `OTP sent to ${userEmailForOtp}.`;
                            forgotPasswordSuccessMessage.classList.remove('hidden');
                            forgotEmailSection.classList.add('hidden');
                            otpVerificationSection.classList.remove('hidden');
                            otpInput.focus();
                        } else {
                            forgotPasswordMessage.textContent = data.response || 'Failed to send OTP. Please check your email.';
                            forgotPasswordMessage.style.color = 'red';
                            forgotPasswordSuccessMessage.classList.add('hidden');
                        }
                    } catch (error) {
                        console.error('Error sending OTP:', error);
                        forgotPasswordMessage.textContent = 'An error occurred. Please try again.';
                        forgotPasswordMessage.style.color = 'red';
                        forgotPasswordSuccessMessage.classList.add('hidden');
                    }
                });
            }

            if (verifyOtpBtn) {
                verifyOtpBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    const otp = otpInput.value;

                    if (!otp) {
                        forgotPasswordMessage.textContent = 'Please enter the OTP.';
                        forgotPasswordMessage.style.color = 'red';
                        return;
                    }

                    forgotPasswordMessage.textContent = 'Verifying OTP...';
                    forgotPasswordMessage.style.color = 'gray';
                    forgotPasswordSuccessMessage.classList.add('hidden');

                    try {
                        // Step 1: Validate OTP
                        const validateOtpResponse = await fetch('https://hhxsq4xb-8000.uks1.devtunnels.ms/validate_otp', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ id: userEmailForOtp, otp: otp })
                        });
                        const validateOtpData = await validateOtpResponse.json();

                        if (validateOtpResponse.ok && validateOtpData.response === 'successful') {
                            forgotPasswordMessage.textContent = '';
                            forgotPasswordSuccessMessage.textContent = 'OTP verified successfully! Please set your new password.';
                            forgotPasswordSuccessMessage.classList.remove('hidden');

                            // IMPORTANT: Hide OTP verification and SHOW reset password overlay
                            setTimeout(() => {
                                hideOverlay(forgotPasswordOverlay);
                                showOverlay(resetPasswordOverlay);
                                newPasswordInput.value = ''; // Clear password fields
                                confirmNewPasswordInput.value = '';
                                resetPasswordMessage.textContent = ''; // Clear messages
                                resetPasswordSuccessMessage.textContent = '';
                            }, 1000); // Give user a moment to read success message
                        } else {
                            forgotPasswordMessage.textContent = validateOtpData.response || 'OTP verification failed. Please try again.';
                            forgotPasswordMessage.style.color = 'red';
                            forgotPasswordSuccessMessage.classList.add('hidden');
                        }
                    } catch (error) {
                        console.error('Error during OTP verification:', error);
                        forgotPasswordMessage.textContent = 'An error occurred. Please try again.';
                        forgotPasswordMessage.style.color = 'red';
                        forgotPasswordSuccessMessage.classList.add('hidden');
                    }
                });
            }

            if (resendOtpLink) {
                resendOtpLink.addEventListener('click', async (e) => {
                    e.preventDefault();
                    forgotPasswordMessage.textContent = 'Resending OTP...';
                    forgotPasswordMessage.style.color = 'gray';
                    forgotPasswordSuccessMessage.classList.add('hidden');
                    otpInput.value = ''; // Clear previous OTP

                    try {
                        const response = await fetch('https://hhxsq4xb-8000.uks1.devtunnels.ms/get_otp', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ id: userEmailForOtp })
                        });
                        const data = await response.json();

                        if (response.ok && data.response === 'successful') {
                            forgotPasswordMessage.textContent = '';
                            forgotPasswordSuccessMessage.textContent = `OTP re-sent to ${userEmailForOtp}.`;
                            forgotPasswordSuccessMessage.classList.remove('hidden');
                            otpInput.focus();
                        } else {
                            forgotPasswordMessage.textContent = data.response || 'Failed to resend OTP. Please try again.';
                            forgotPasswordMessage.style.color = 'red';
                            forgotPasswordSuccessMessage.classList.add('hidden');
                        }
                    } catch (error) {
                        console.error('Error resending OTP:', error);
                        forgotPasswordMessage.textContent = 'An error occurred. Please try again.';
                        forgotPasswordMessage.style.color = 'red';
                        forgotPasswordSuccessMessage.classList.add('hidden');
                    }
                });
            }
            /* --- End Forgot Password Logic with OTP --- */

            /* --- NEW: Reset Password Logic (The Third Page) --- */
            if (closeResetPasswordOverlay) {
                closeResetPasswordOverlay.addEventListener('click', () => {
                    hideOverlay(resetPasswordOverlay);
                    showOverlay(loginOverlay); // Go back to login
                });
            }

            if (setNewPasswordBtn) {
                setNewPasswordBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    const newPassword = newPasswordInput.value;
                    const confirmNewPassword = confirmNewPasswordInput.value;

                    resetPasswordMessage.textContent = '';
                    resetPasswordSuccessMessage.textContent = '';

                    if (!newPassword || !confirmNewPassword) {
                        resetPasswordMessage.textContent = 'Please fill in both password fields.';
                        resetPasswordMessage.style.color = 'red';
                        return;
                    }

                    if (newPassword !== confirmNewPassword) {
                        resetPasswordMessage.textContent = 'Passwords do not match.';
                        resetPasswordMessage.style.color = 'red';
                        return;
                    }

                    resetPasswordMessage.textContent = 'Setting new password...';
                    resetPasswordMessage.style.color = 'gray';

                    try {
                        // This is the call to the backend for changing the password
                        const response = await fetch('https://hhxsq4xb-8000.uks1.devtunnels.ms/change_password', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ id: userEmailForOtp, password: newPassword }) // 'id' is the email, 'password' is the new password
                        });
                        const data = await response.json();

                        if (response.ok && data.response === 'successful') {
                            resetPasswordMessage.textContent = '';
                            resetPasswordSuccessMessage.textContent = 'Password changed successfully! You can now log in with your new password.';
                            resetPasswordSuccessMessage.classList.remove('hidden');

                            setTimeout(() => {
                                hideOverlay(resetPasswordOverlay);
                                showOverlay(loginOverlay);
                                loginMessage.textContent = 'Password reset successful. Please log in with your new password.';
                                loginMessage.style.color = 'green';
                            }, 3000); // Give user time to read the message
                        } else {
                            resetPasswordMessage.textContent = data.response || 'Failed to change password. Please try again.';
                            resetPasswordMessage.style.color = 'red';
                            resetPasswordSuccessMessage.classList.add('hidden');
                        }
                    } catch (error) {
                        console.error('Error setting new password:', error);
                        resetPasswordMessage.textContent = 'An error occurred. Please try again.';
                        resetPasswordMessage.style.color = 'red';
                        resetPasswordSuccessMessage.classList.add('hidden');
                    }
                });
            }
            /* --- End NEW: Reset Password Logic --- */
        });
    </script>
</body>
</html>
